# Nordic Climate Community and EOSC

EOSC Nordic activities and synergies with other EOSC projects such as EOSC-Life and EOSC-Pillar.

In this working document, we try to identify areas where EOSC-Nordic and the Nordic Climate Community could collaborate with other EOSC related projects to fotser and advance take-up of of the European Open Science Cloud.

## EOSC demonstrators

Both [EOSC-Pillar](https://www.eosc-pillar.eu) and [EOSC-Nordic](https://www.eosc-nordic.eu) have use cases and community driven pilots:


- [EOSC-Pillar Use cases](https://www.eosc-pillar.eu/use-cases-and-community-driven-pilots)
- [EOSC-Nordic Use cases](https://www.eosc-nordic.eu/demonstrating-eosc-nordic/)


## Roadmaps

### EOSC-Life tool roadmap


<img src="https://github.com/eosc-life/tools-collaboratory-roadmap/raw/master/images/EOSC-Life_T2.1.png" />
*Reference*: [https://github.com/eosc-life/tools-collaboratory-roadmap](https://github.com/eosc-life/tools-collaboratory-roadmap)

### EOSC-Nordic tool roadmap for the Climate community

Rather than reinventing the wheel, EOSC-Nordic chose to base its roadmap on the [EOSC-Life tools roadmap](https://github.com/eosc-life/tools-collaboratory-roadmap) and reuse as many components as possible for the Climate community. Strengthening collaboration with Galaxy Community and EOSC-Life is an integral part of its plan.

<img src="EOSC-Nordic_climate_tools_roadmap.png" />


## Data

### IDC - Intergalactic (reference) Data Commission

- [https://github.com/galaxyproject/idc/](https://github.com/galaxyproject/idc/) github repository is the entry point to contribute to the community-maintained CVMFS data repository, hosting approximately 6TB of public and open reference datasets.

### Climate (reference) Data

The size of climate datasets can be large (several PB) and making several copies on various Galaxy instance may not be a reasonnable approach.

The current approach for climate datasets is to use cloud storage and [zarr](https://zarr.readthedocs.io/en/stable/) so that anyone can seamingless access data remotely (faster access when locally available; should we then move tools to data?)

We usually distinguish "reference" data from "research data":

- **Reference data**: Climate data officially delivered by data providers (Copernicus, NOAA, EUMETSAT, WRCP). The goal will be to write Galaxy tool to facilitate access to these datasets within Galaxy. We may copy some datasets locally (for fast access and avoid duplication) and/or create workflows that automatically delete the raw dataset (as they can be retrieved again from the data provider).
- **research data**: climate data generated by researchers may not contain sufficient metadata to be easily reused. Here we need to develop tools to "standardize" datasets and allow publication on cloud storage.

### Possible collaboration

The approach chosen by the climate community may be suitable for other communities.

We need to analyze and understand how all these different approaches can be supported by the Galaxy ecosystem (rather than trying to fit everyone within one framework).

The work planned within EOSC-Nordic framework and [WP5: Open Research data and services â€“ demonstrators](https://www.eosc-nordic.eu/organisation/) could serve as a base for further collaboration work.

## Tools & packaging

So far we have use [bioconda](http://bioconda.github.io/) so that we would automatically get the corresponding docker container. 

This means that our tools appear in [biocontainers.pro](https://biocontainers.pro/#/). [CESM](http://www.cesm.ucar.edu/) is a concrete example:
- [cesm in bioconda](https://bioconda.github.io/recipes/cesm/README.html)
- [cesm in biocontainers.pro](https://biocontainers.pro/#/tools/cesm)

### Possible collaboration

The collabroation is already effective. A few questions:

- Is it relevant to add all our tools to bioconda? Will the bioconda community be happy with it?
- Some of our tools & libraries are already in [conda-forge](https://conda-forge.org/) but we usually do not have the corresponding container. Should we rather use [conda-forge](https://conda-forge.org/) and then how would we automatically generate containers?

## Workflows

[Workflow hub](https://workflowhub.eu/) developments are driven by [EOSC-Life](https://www.eosc-life.eu/). Most of the work is generic and perfectly reusable by other communities.

A [workflow Hub Github organization](https://github.com/workflowhub-eu/) has been created.

### Workflow Hub Climate Team

Any workflows related to the Climate community and generated within Galaxy (either with interactive JupyterLab or with Galaxy tools) can be deposited to the [Climate Team](https://workflowhub.eu/projects/18).


### Possible collaboration

- [galaxy2cwl](https://github.com/workflowhub-eu/galaxy2cwl): contribute to enhancement of **galaxy2cwl**.
- As the climate community also makes use of [cylc](https://cylc.github.io/), we could also contribute to workflow Hub by developing and maintaining a tool to convert to [CWL](https://www.commonwl.org/) e.g. **cylc2cwl**.

This work could be done by the [NICEST2](https://neic.no/nicest2/) (Nordic Collaboration on e-Infrastructures for Earth System Modeling) and [WP4: ESM workflows to efficiently run NorESM and EC-Earth on euroHPC](https://nordicesmhub.github.io/nicest2/2020/05/04/plan.html#wp4-esm-workflows-to-efficiently-run-noresm-and-ec-earth-on-eurohpc). 

## Infrastructure

The Climate community mostly relies on the use of High Performance Computing for running operational simulations. However, with the use of Galaxy, we have demonstrated that cloud computing can provide a better framework for model development, teaching and most data analysis performed by researchers.

EOSC-Nordic investigates (at a policy level) on how to solve issues related to different access, accounting, authentication policies.

## Registries

### bio.tools 

The Climate Community could reuse what is done for [bio.tools](https://bio.tools/).

### biocontainers

As mentioned above, tools we have added to bioconda are also listed in [biocontainers.pro](https://biocontainers.pro/#/).

### Possible collaboration

With other communities interested in having registries for their tools and containers, the main question is whether we should "duplicate" or "generalize" what has been done for the Life Science community.

- should we have a more generic **science.tools** and **scicontainters.pro** orshould we define (for each community) specific registries?

## Training

### EOSC-Life Training Open Call

An application was submitted to [EOSC-Life Training Open Call](https://www.eosc-life.eu/services/open-call-training/) and accepted.

#### Development of CLM-FATES training course

The main objective of the course is to learn how to compose and execute repeatable and reproducible modelling workflow with FATES (Functional Assembled Terrestrial Ecosystem Simulator). FATES is a numerical terrestrial ecosystem model for use in Earth System Models (ESM) that simulates and predicts growth, death, and regeneration of plants and subsequent tree size distributions. The simulation is done by allowing plants with different traits to compete for light, water, and nutrients, within an environment that tracks both natural and anthropogenic disturbance and recovery. FATES introduces ecosystem demography and dynamic vegetation into the structure of the land surface components of ESMs, allowing for full coupling to global atmosphere, ocean, and sea-ice processes. FATES is currently coupled to several Earth System Models, including CESM (Community Earth System Model), CTSM (Community Terrestrial Systems Model) and E3SM (Energy Exascale Earth System Model).

The learning objectives include:

- Understanding ecological, biogeochemical, biogeophysical, and hydrologic theory underpinning the CTSM.
- Running CLM-FATES in Galaxy for single-point locations where in-situ measurements are available.
- Analyzing CLM-FATES output and comparing it with observations.
- Sharing data (results from the simulations, in-situ data) using FAIR principles.
- Composing, executing and publishing the corresponding Galaxy workflow. 


During [BCC2020 CollaborationFest](https://bcc2020.github.io/cofest/) we have started to draft a Galaxy tutorial:
- [github repository with fates tutorial](https://github.com/NordicESMhub/galaxy-training-material/tree/fates/topics/climate/tutorials/fates)
- [Corresponding Pull Request in GTN](https://github.com/galaxyproject/training-material/pull/1993)

More information will come as the project starts.


